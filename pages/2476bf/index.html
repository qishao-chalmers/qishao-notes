<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Cache Memory Compression | CPU &amp; GPU Microarch. Qi Shao</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="stylesheet" href="custom.css">
    <script language="javascript" type="text/javascript" src="/qishao-notes/js/pgmanor-self.js"></script>
    <meta name="description" content="Computer System">
    <meta name="google-site-verification" content="66w5U9NY5gJWu7iBtHKMbhpXkV94jy31L_RHbvrZZzY">
    <meta name="keywords" content="Hitqishao,golang,vue,go-web,go-admin,go-ldap-admin">
    <meta name="theme-color" content="#11a8cd">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <link rel="preload" href="/qishao-notes/assets/css/0.styles.922e50b3.css" as="style"><link rel="preload" href="/qishao-notes/assets/js/app.15b97e8a.js" as="script"><link rel="preload" href="/qishao-notes/assets/js/2.9488d546.js" as="script"><link rel="preload" href="/qishao-notes/assets/js/17.80faad40.js" as="script"><link rel="prefetch" href="/qishao-notes/assets/js/10.e391c216.js"><link rel="prefetch" href="/qishao-notes/assets/js/100.cc547ac3.js"><link rel="prefetch" href="/qishao-notes/assets/js/11.eb524b92.js"><link rel="prefetch" href="/qishao-notes/assets/js/12.0eb81a31.js"><link rel="prefetch" href="/qishao-notes/assets/js/13.02751c9f.js"><link rel="prefetch" href="/qishao-notes/assets/js/14.398474f0.js"><link rel="prefetch" href="/qishao-notes/assets/js/15.08e9a735.js"><link rel="prefetch" href="/qishao-notes/assets/js/16.95175d40.js"><link rel="prefetch" href="/qishao-notes/assets/js/18.07d5df88.js"><link rel="prefetch" href="/qishao-notes/assets/js/19.7e55c536.js"><link rel="prefetch" href="/qishao-notes/assets/js/20.76601c10.js"><link rel="prefetch" href="/qishao-notes/assets/js/21.0a7a876b.js"><link rel="prefetch" href="/qishao-notes/assets/js/22.5653cd65.js"><link rel="prefetch" href="/qishao-notes/assets/js/23.7d82567b.js"><link rel="prefetch" href="/qishao-notes/assets/js/24.f16d18ad.js"><link rel="prefetch" href="/qishao-notes/assets/js/25.59b02356.js"><link rel="prefetch" href="/qishao-notes/assets/js/26.c7b0c011.js"><link rel="prefetch" href="/qishao-notes/assets/js/27.efac147b.js"><link rel="prefetch" href="/qishao-notes/assets/js/28.c36d3ee8.js"><link rel="prefetch" href="/qishao-notes/assets/js/29.9c4e4688.js"><link rel="prefetch" href="/qishao-notes/assets/js/3.c6cba72d.js"><link rel="prefetch" href="/qishao-notes/assets/js/30.845402ca.js"><link rel="prefetch" href="/qishao-notes/assets/js/31.4e37df24.js"><link rel="prefetch" href="/qishao-notes/assets/js/32.06343959.js"><link rel="prefetch" href="/qishao-notes/assets/js/33.f721dec8.js"><link rel="prefetch" href="/qishao-notes/assets/js/34.ecd3ee66.js"><link rel="prefetch" href="/qishao-notes/assets/js/35.1b806ad1.js"><link rel="prefetch" href="/qishao-notes/assets/js/36.c2cd685c.js"><link rel="prefetch" href="/qishao-notes/assets/js/37.72bddc0c.js"><link rel="prefetch" href="/qishao-notes/assets/js/38.486869a9.js"><link rel="prefetch" href="/qishao-notes/assets/js/39.20dc86e5.js"><link rel="prefetch" href="/qishao-notes/assets/js/4.43d9d83d.js"><link rel="prefetch" href="/qishao-notes/assets/js/40.485804d3.js"><link rel="prefetch" href="/qishao-notes/assets/js/41.e84ccf0a.js"><link rel="prefetch" href="/qishao-notes/assets/js/42.9a84b4fe.js"><link rel="prefetch" href="/qishao-notes/assets/js/43.dd61f910.js"><link rel="prefetch" href="/qishao-notes/assets/js/44.65f0324a.js"><link rel="prefetch" href="/qishao-notes/assets/js/45.d10bc3f4.js"><link rel="prefetch" href="/qishao-notes/assets/js/46.5ba57bf3.js"><link rel="prefetch" href="/qishao-notes/assets/js/47.33df5712.js"><link rel="prefetch" href="/qishao-notes/assets/js/48.ed2999ed.js"><link rel="prefetch" href="/qishao-notes/assets/js/49.893f4076.js"><link rel="prefetch" href="/qishao-notes/assets/js/5.e730adaa.js"><link rel="prefetch" href="/qishao-notes/assets/js/50.8bd1b68c.js"><link rel="prefetch" href="/qishao-notes/assets/js/51.8c78866f.js"><link rel="prefetch" href="/qishao-notes/assets/js/52.93caeab2.js"><link rel="prefetch" href="/qishao-notes/assets/js/53.87e3caca.js"><link rel="prefetch" href="/qishao-notes/assets/js/54.2934a37c.js"><link rel="prefetch" href="/qishao-notes/assets/js/55.7979d51a.js"><link rel="prefetch" href="/qishao-notes/assets/js/56.57b18a57.js"><link rel="prefetch" href="/qishao-notes/assets/js/57.601effa5.js"><link rel="prefetch" href="/qishao-notes/assets/js/58.5f83350d.js"><link rel="prefetch" href="/qishao-notes/assets/js/59.e3c782e9.js"><link rel="prefetch" href="/qishao-notes/assets/js/6.9189a901.js"><link rel="prefetch" href="/qishao-notes/assets/js/60.bfc85820.js"><link rel="prefetch" href="/qishao-notes/assets/js/61.d15aa149.js"><link rel="prefetch" href="/qishao-notes/assets/js/62.3ef2d83d.js"><link rel="prefetch" href="/qishao-notes/assets/js/63.7f599aa6.js"><link rel="prefetch" href="/qishao-notes/assets/js/64.f53e2930.js"><link rel="prefetch" href="/qishao-notes/assets/js/65.4733b917.js"><link rel="prefetch" href="/qishao-notes/assets/js/66.a8d0be31.js"><link rel="prefetch" href="/qishao-notes/assets/js/67.eaf66463.js"><link rel="prefetch" href="/qishao-notes/assets/js/68.97735d38.js"><link rel="prefetch" href="/qishao-notes/assets/js/69.fce6e2f3.js"><link rel="prefetch" href="/qishao-notes/assets/js/7.7dc4a3e5.js"><link rel="prefetch" href="/qishao-notes/assets/js/70.61cf9adf.js"><link rel="prefetch" href="/qishao-notes/assets/js/71.a2a94854.js"><link rel="prefetch" href="/qishao-notes/assets/js/72.b93fe88b.js"><link rel="prefetch" href="/qishao-notes/assets/js/73.1bdf9824.js"><link rel="prefetch" href="/qishao-notes/assets/js/74.46934839.js"><link rel="prefetch" href="/qishao-notes/assets/js/75.a9212cbe.js"><link rel="prefetch" href="/qishao-notes/assets/js/76.c8d54deb.js"><link rel="prefetch" href="/qishao-notes/assets/js/77.d759c239.js"><link rel="prefetch" href="/qishao-notes/assets/js/78.7a556637.js"><link rel="prefetch" href="/qishao-notes/assets/js/79.9025003e.js"><link rel="prefetch" href="/qishao-notes/assets/js/8.cd705a28.js"><link rel="prefetch" href="/qishao-notes/assets/js/80.2cb14f3d.js"><link rel="prefetch" href="/qishao-notes/assets/js/81.274287c3.js"><link rel="prefetch" href="/qishao-notes/assets/js/82.13cedee5.js"><link rel="prefetch" href="/qishao-notes/assets/js/83.15f52e23.js"><link rel="prefetch" href="/qishao-notes/assets/js/84.390971d8.js"><link rel="prefetch" href="/qishao-notes/assets/js/85.c71dde83.js"><link rel="prefetch" href="/qishao-notes/assets/js/86.65f6f816.js"><link rel="prefetch" href="/qishao-notes/assets/js/87.b0729009.js"><link rel="prefetch" href="/qishao-notes/assets/js/88.930ec243.js"><link rel="prefetch" href="/qishao-notes/assets/js/89.f777933d.js"><link rel="prefetch" href="/qishao-notes/assets/js/9.69c83650.js"><link rel="prefetch" href="/qishao-notes/assets/js/90.d25884e4.js"><link rel="prefetch" href="/qishao-notes/assets/js/91.4cc04809.js"><link rel="prefetch" href="/qishao-notes/assets/js/92.8c79195c.js"><link rel="prefetch" href="/qishao-notes/assets/js/93.1e1dbc96.js"><link rel="prefetch" href="/qishao-notes/assets/js/94.ee8e01c0.js"><link rel="prefetch" href="/qishao-notes/assets/js/95.9e92be6e.js"><link rel="prefetch" href="/qishao-notes/assets/js/96.d2319f84.js"><link rel="prefetch" href="/qishao-notes/assets/js/97.6bc12b88.js"><link rel="prefetch" href="/qishao-notes/assets/js/98.4ad60bf2.js"><link rel="prefetch" href="/qishao-notes/assets/js/99.1c38a6fc.js">
    <link rel="stylesheet" href="/qishao-notes/assets/css/0.styles.922e50b3.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/qishao-notes/" class="home-link router-link-active"><!----> <span class="site-name">CPU &amp; GPU Microarch. Qi Shao</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/qishao-notes/" class="nav-link">Home</a></div><div class="nav-item"><a href="/qishao-notes/gpu/" class="nav-link">gpu</a></div><div class="nav-item"><a href="/qishao-notes/cpu/" class="nav-link">cpu</a></div><div class="nav-item"><a href="/qishao-notes/llm/" class="nav-link">ml&amp;llm</a></div><div class="nav-item"><a href="/qishao-notes/compiler/" class="nav-link">compiler</a></div><div class="nav-item"><a href="/qishao-notes/hbm/" class="nav-link">hbm</a></div><div class="nav-item"><a href="/qishao-notes/mix/" class="nav-link">program</a></div><div class="nav-item"><a href="/qishao-notes/unix/" class="nav-link">unix</a></div><div class="nav-item"><a href="https://blog.csdn.net/hit_shaoqi" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/hitqshao/qishao-notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/qishao-notes/" class="nav-link">Home</a></div><div class="nav-item"><a href="/qishao-notes/gpu/" class="nav-link">gpu</a></div><div class="nav-item"><a href="/qishao-notes/cpu/" class="nav-link">cpu</a></div><div class="nav-item"><a href="/qishao-notes/llm/" class="nav-link">ml&amp;llm</a></div><div class="nav-item"><a href="/qishao-notes/compiler/" class="nav-link">compiler</a></div><div class="nav-item"><a href="/qishao-notes/hbm/" class="nav-link">hbm</a></div><div class="nav-item"><a href="/qishao-notes/mix/" class="nav-link">program</a></div><div class="nav-item"><a href="/qishao-notes/unix/" class="nav-link">unix</a></div><div class="nav-item"><a href="https://blog.csdn.net/hit_shaoqi" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CSDN
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/hitqshao/qishao-notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/qishao-notes/pages/24769e/" class="sidebar-link">HBM Paper List</a></li><li><a href="/qishao-notes/pages/2476af/" class="sidebar-link">HBM Dead Block Predictor</a></li><li><a href="/qishao-notes/pages/24769f/" class="sidebar-link">Dynamically Adapting  Page Migration Policies Based on Applications Memory Access Behaviors</a></li><li><a href="/qishao-notes/pages/24760e/" class="sidebar-link">DRAM PCM NVM Cache</a></li><li><a href="/qishao-notes/pages/2476bf/" aria-current="page" class="active sidebar-link">Cache Memory Compression</a></li><li><a href="/qishao-notes/pages/f07695/" class="sidebar-link">memory-ecc</a></li><li><a href="/qishao-notes/pages/f07696/" class="sidebar-link">hbm-latency</a></li><li><a href="/qishao-notes/pages/f07698/" class="sidebar-link">compression</a></li><li><a href="/qishao-notes/pages/f07699/" class="sidebar-link">compressibility prediction</a></li><li><a href="/qishao-notes/pages/f07692/" class="sidebar-link">memory management</a></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper bg-style-6"><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/qishao-notes/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/qishao-notes/hbm/#hbm" data-v-06225672>hbm</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/hitqshao" target="_blank" title="作者" class="beLink" data-v-06225672>hitqishao</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-06-06</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><!----> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">Cache Memory Compression<!----></h1> <!----> <div class="theme-vdoing-content content__default"><ol><li>Compresso: Pragmatic Main Memory Compression</li> <li>Translation-optimized Memory Compression for Capacity</li> <li>Touche: Towards Ideal and Efficient Cache Compression By Mitigating Tag Area Overheads</li></ol> <hr> <h4 id="_1-compresso-pragmatic-main-memory-compression"><a href="#_1-compresso-pragmatic-main-memory-compression" class="header-anchor">#</a> 1. Compresso: Pragmatic Main Memory Compression</h4> <p>Cite from the paper:
We propose Compresso, with optimizations to reduce compressed data movement in a hardware compressed memory, while maintaining high compression ratio by repacking data at the right time.</p> <p>Compresso uses the modified BPC compression algorithm, achieving 1.85x average compression on a wide range of applications.</p> <p>Compresso uses the compression granularity of 64B.</p> <p>Compresso uses LinePack with 4 possible cache line sizes.</p> <p>We compare variable-sized chunks (512B, 1KB, 2KB and 4KB) with 512B fixed-sized chunks. Compresso uses incremental allocation in 512B chunks,thereby allowing 8 page sizes (512B, 1KB, 1.5KB and so on).</p> <p><img src="https://github.com/hitqshao/qishao-notes/assets/23403286/d8d83212-ff2b-4f84-85c1-454255ee5e98" alt="image"></p> <p>Additional Data Movement:</p> <ol><li>split-access cachelines</li> <li>changes in compressibility(overflows)</li> <li>metadata access</li></ol> <p><img src="https://github.com/hitqshao/qishao-notes/assets/23403286/d04d18a4-5678-428c-a2cf-d1bc43ca2f3f" alt="image"></p> <p>Difference in exception in LCP compression
Instead, Compresso allows some number of such inflated cachelines to be stored uncompressed in the inflation room at the end of an MPA page, provided that there is space in that page (Fig. 5a). This is similar to the
exception region in LCP, but is used for an entirely different reason—to reduce compression-related data movement, rather than to support a specific packing scheme.</p> <p><img src="https://github.com/hitqshao/qishao-notes/assets/23403286/c97e0467-88e3-43a9-b25f-3d43477744d5" alt="image"></p> <p>We present the first main-memory compression architecture that is designed to run an unmodified operating system.</p> <hr> <h4 id="_2-translation-optimized-memory-compression-for-capacity"><a href="#_2-translation-optimized-memory-compression-for-capacity" class="header-anchor">#</a> 2. Translation-optimized Memory Compression for Capacity</h4> <p>prior workscompress and pack/migrate data at a small - memory block-level - granularity; this introduces an additional block-level translation after the page-level virtual address translation. In general, the smaller the granularity of address translation, the higher the translation overhead.</p> <p>A promising solution is to only save memory from cold (i.e.,less recently accessed) pages without saving memory from hot (i.e., more recently accessed) pages (e.g., keep the hot pages
uncompressed).</p> <p>Two challenges:</p> <ol><li>after a compressed cold page becomes hot again, migrating the page to a full 4KB DRAM location still adds another level (albeit page-level, instead of block-level) of translation on top of existing virtual address translation.
<strong>Solution</strong>
we propose compressing page table blocks in hardware to opportunistically embed compression translations into them in a software-transparent manner to effectively prefetch compression translations during a page walk, instead of serially fetching them after the walk.</li></ol> <p>First, CTE misses typically occur after PTE misses in TLB because CTEs, especially the page-level CTEs under an OS-inspired approach, have similar translation reach as PTEs.
Second, we observe page table blocks (PTBs) are highly compressible because adjacent virtual pages often have identical status bits and the most significant bits in physical page numbers are unused.
As such, to hide the latency of CTE misses, TMCC transparently compresses each PTB in hardware to free up space in the PTB to embed the CTEs of the 4KB pages (i.e., either data pages or page table pages) that the PTB points to; this enables each page walk to also prefetch the matching CTE required for fetching from DRAM either the end data or the next PTB.</p> <ol start="2"><li>only compressing cold data require compressing them very aggressively to achieve high overall memory savings.
<strong>Solution</strong>
we perform a large design space exploration across many hardware configurations and diverse workloads to derive and implement in HDL an ASIC Deflate that is specialized for memory.</li></ol> <p>Prior new hardware managed translation entries as Compression Translation Entries (CTEs), as they are similar to OS page table entries (PTEs). Prior works cache CTEs in the memory controller via a dedicated CTE cache, similar to the TLBs dedicated to caching PTEs.</p> <p>let hardware take on an OS-inspired approach: only save memory from cold (i.e., less recently accessed) pages without saving memory from hot (i.e., recently accessed) pages (e.g., keep the hot pages uncompressed), like OS memory compression.
Solves the problem of</p> <ol><li>translation overheads that large and/or irregular workloads suffer from high PTE miss under hardware memory compression.</li> <li>Fine-grained address translation</li></ol> <p>Accesses to a compressed virtual page in ML2 incurs a page fault to wake up OS to pop a free physical page from ML1’s free list and migrate the virtual page to the page.</p> <p>ML2 also keeps many free lists, each tracking sub-physical pages of a different size, to store any compressed virtual page in a practically ideal matching sub-physical page.</p> <p>ML2 gracefully grows and shrinks relative to ML1 with increasing and decreasing memory usage. When everything can fit in memory uncompressed, ML2 shrinks to zero bytes in physical size so ML1 can have every physical page. Specifically, when ML2’s free list(s) get large (e.g., due to reducing memory usage), ML2 donates free physical pages from its free list(s) to ML1.
OS also grows ML1 free list, when it gets small, by migrating cold virtual pages to ML2.
Migrating a virtual page to ML2 shrinks one of ML2’s free lists. If a ML2 free list gets empty, ML1 gives cold victim physical pages to ML2 (i.e., track them in ML2 instead of ML1), so that ML2 can compress the virtual pages currently in the victim pages to free space in the victims to grow ML2’s free list(s).</p> <p><img src="https://github.com/hitqshao/qishao-notes/assets/23403286/a8a3f90b-4334-4d5b-a7ad-3a158b9f0966" alt="image"></p> <p>Key Idea: Based on our observations, we propose transparently compressing each PTB in hardware to free up space in the PTB to embed the CTEs of the 4KB pages (i.e., either data pages or page table pages) that the PTB points to; this enables each page walk access to also prefetch the matching CTE required either for the next page walk access (i.e., to the next PTB) or for the actual data (or instruction) access after the walk.
<img src="https://github.com/hitqshao/qishao-notes/assets/23403286/58f6c74a-d910-4c85-9811-2f74a15aec07" alt="image"></p> <p><img src="https://github.com/hitqshao/qishao-notes/assets/23403286/744c2c42-6a02-42df-8d19-ccd707abe9ad" alt="image"></p> <p>A practical challenge is that after migrating a page (e.g., from ML1 to ML2 after the page becomes cold), the corresponding CTE embedded in the page’s PTB should be updated. However, hardware has no easy way to use the PPN of the migrating page to find/access the page’s PTB(s).
TMCC addresses this challenge by lazily updating the CTE in the PTB later around when the PTB is naturally accessed by the page walker, instead of updating it at the time of migrating the page.
However, this means that for the first page walker access to the PTB after migrating one of the pages that the PTB points to, the corresponding CTE is out-of-date.
To ensure correctness, TMCC also accesses the correct CTE in DRAM (or in CTE cache) in parallel to verify the correctness of the DRAM access.
Figure 8 compares and contrasts how TMCC serves an LLC miss that also misses in CTE cache with the baseline approach.
Figure 9 provides n architectural overview of TMCC.</p> <p><img src="https://github.com/hitqshao/qishao-notes/assets/23403286/d351dbe2-dc03-4069-8977-0c17dc3300e0" alt="image"></p> <p><img src="https://github.com/hitqshao/qishao-notes/assets/23403286/60eeac47-a9c5-4589-8ecb-e23578097575" alt="image"></p> <p><img src="https://github.com/hitqshao/qishao-notes/assets/23403286/6c31c55f-6120-42fe-882a-a707129eadcf" alt="image"></p> <p><strong>My Comment</strong>
When os access compressed page, that page is migrated from ML2 to ML1. Hardware cannot update the PTB easily. Thus it utilizes lazily update.
During the page table walk, it will buffer the piggybacked CTE into CTE buffer. And when data miss req happens,  L2 extracts the PPN from the received request to lookup the CTE Buffer to obtain the CTE for MC to translate the PPN.</p> <hr> <h4 id="_3-touche-towards-ideal-and-efficient-cache-compression-by-mitigating-tag-area-overheads"><a href="#_3-touche-towards-ideal-and-efficient-cache-compression-by-mitigating-tag-area-overheads" class="header-anchor">#</a> 3. Touche: Towards Ideal and Efficient Cache Compression By Mitigating Tag Area Overheads</h4> <p>The first component, called the “Signature” (SIGN) engine, creates shortened signatures from the tag addresses of compressed blocks. Due to this, the SIGN engine can store multiple signatures in each tag entry. On a cache access, the physical cacheline is accessed only if there is a signature match (which has a negligible probability of false positive).
The second component, called the “Tag Appended Data” (TADA) mechanism, stores the full tag addresses with data. TADA enables Touch´e to detect false positive signature matches by ensuring that the actual tag address is available for comparison.
The third component, called the “Superblock Marker” (SMARK) mechanism, uses a unique marker in the tag entry to indicate the occurrence of compressed cache blocks from neighboring physical addresses in the same cacheline.</p> <p><img src="https://github.com/hitqshao/qishao-notes/assets/23403286/c359f253-63dd-4354-8a41-4fb91975d2a9" alt="image"></p> <p>On average, 55% of the blocks can be compressed to less than 48 bytes in size. Furthermore, 17% of the lines can be compressed to be less than 16 bytes in size. Therefore, several workloads tend to have blocks with low entropy and can benefit from compression.</p> <p><img src="https://github.com/hitqshao/qishao-notes/assets/23403286/3f38d55a-e469-41f7-b102-f06d63432298" alt="image"></p> <p><img src="https://github.com/hitqshao/qishao-notes/assets/23403286/7b258b8a-8488-4b8b-b009-bd3c8e17bc51" alt="image"></p> <p><img src="https://github.com/hitqshao/qishao-notes/assets/23403286/3e2a0253-22ba-4ae0-8a60-bc14179c1b52" alt="image"></p> <p>For instance, a cacheline cannot be marked both invalid and dirty at the same time. The tag manager uses this unused state to flag cachelines that contains compressed blocks. Thereafter, for a cacheline that stores compressed blocks, the 1st and 2nd bits of the tag address encodes its valid bit and dirty bit.</p> <p><img src="https://github.com/hitqshao/qishao-notes/assets/23403286/e3b82585-7f61-44ef-b7b7-c19bc021a522" alt="image"></p> <p><img src="https://github.com/hitqshao/qishao-notes/assets/23403286/ef49a85e-7589-4d5d-a6d2-f01167d19fbe" alt="image"></p> <p>The tag manager then retrieves the 16-bit marker from the SMARK mechanism. It then informs the SIGN engine to ignore the last 2-bits (corresponding to four neighboring addresses) of the full tag address to generate a unique 9-bit signature.</p> <p>This SMARK generate a random 16-bit marker and concated with signature. Since non-superblocks use 3 signature to identify blks, it should also use a tag to compare not just 0.</p> <p>If this paper doest not support superblock 4 compressed blks in a super block, it can only store 3* 16B compressed block or 48B + 64B block, due to extra real tag stored in data, 43bit for each data.</p></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/hitqshao/qishao-notes/edit/main/docs/01.hbm/05.cache_mem_compression.md" target="_blank" rel="noopener noreferrer">帮助我们改善此页面</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2025/01/14, 21:24:47</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/qishao-notes/pages/24760e/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">DRAM PCM NVM Cache</div></a> <a href="/qishao-notes/pages/f07695/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">memory-ecc</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/qishao-notes/pages/24760e/" class="prev">DRAM PCM NVM Cache</a></span> <span class="next"><a href="/qishao-notes/pages/f07695/">memory-ecc</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="https://github.com/hitqshao" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="mailto:hitqshao@163.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://gitee.com/hitqshao" title="Gitee" target="_blank" class="iconfont icon-gitee"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2022-2025
    <span>Eryajf | <a href="https://github.com/hitqshao/qishao-notes/blob/main/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><!----></div></div>
    <script src="/qishao-notes/assets/js/app.15b97e8a.js" defer></script><script src="/qishao-notes/assets/js/2.9488d546.js" defer></script><script src="/qishao-notes/assets/js/17.80faad40.js" defer></script>
  </body>
</html>
